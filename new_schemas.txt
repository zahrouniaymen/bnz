# Add these schemas to the end of backend/schemas.py

# ============= User Performance Schemas =============

class UserPerformanceMetrics(BaseModel):
    user_id: int
    period: str  # "2024-01", "2024-02", etc.
    offers_handled: int = 0
    avg_processing_time_hours: float = 0.0
    success_rate: float = 0.0
    current_workload: int = 0
    avg_response_time_hours: float = 0.0
    total_hours_worked: float = 0.0
    declined_count: int = 0
    accepted_count: int = 0
    
    class Config:
        from_attributes = True


class TeamPerformanceSummary(BaseModel):
    period: str
    team_members: List[UserPerformanceMetrics]
    total_offers: int
    avg_success_rate: float
    total_workload: int


# ============= Workflow Timing Schemas =============

class WorkflowTimingStats(BaseModel):
    phase: str
    avg_duration_hours: float
    min_duration_hours: float
    max_duration_hours: float
    bottleneck_count: int
    total_steps: int


class BottleneckAlert(BaseModel):
    offer_id: int
    offer_number: str
    client_name: str
    phase: str
    duration_hours: float
    threshold_hours: float
    assigned_user: Optional[str] = None


# ============= Seasonal Trends Schemas =============

class MonthlyTrend(BaseModel):
    month: str  # "2024-01"
    total_offers: int
    accepted: int
    declined: int
    avg_value: float
    prediction_next_month: Optional[int] = None


class SeasonalPattern(BaseModel):
    month_number: int  # 1-12
    avg_volume: float
    peak_indicator: bool
    year_over_year_change: Optional[float] = None


# ============= Client Loyalty Schemas =============

class ClientLoyaltyMetrics(BaseModel):
    client_id: int
    client_name: str
    loyalty_score: float
    new_items_count: int
    reorder_count: int
    total_offers: int
    reorder_percentage: float
    last_order_date: Optional[datetime] = None
